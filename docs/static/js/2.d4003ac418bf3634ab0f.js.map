{"version":3,"sources":["webpack:///./src/api/the-artist.js","webpack:///src/base/base-artist-list.vue","webpack:///./src/base/base-artist-list.vue?2b9b","webpack:///./src/base/base-artist-list.vue","webpack:///src/components/the-artist/artist.vue","webpack:///./src/components/the-artist/artist.vue?01d2","webpack:///./src/components/the-artist/artist.vue"],"names":["data","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","__WEBPACK_IMPORTED_MODULE_2__config__","channel","page","key","pagesize","pagenum","hostUin","needNewCode","platform","g_tk","Object","__WEBPACK_IMPORTED_MODULE_1__common_js_jsonp__","artistId","order","begin","num","songstatus","singermid","base_artist_list","Array","difference","anchorIndex","pageY","refresh","y","group","height","clientHeight","item","_this","this","_calculateHeight","i","newY","BaseScroll","base_scroll","BaseLoading","base_loading","base_base_artist_list","render","_vm","_h","$createElement","_c","_self","ref","staticClass","attrs","artistData","listenScroll","probeType","on","scroll","_l","index","refInFor","_v","_s","title","childIndex","click","$event","selectItem","directives","name","rawName","value","expression","width","alt","class","currentIndex","data-index","touchstart","onShortcutToTouchStart","touchmove","stopPropagation","preventDefault","onShortcutToTouchMove","scrollY","style","fixedTitle","length","_e","staticRenderFns","src_base_base_artist_list","__webpack_require__","normalizeComponent","ssrContext","artist","methods","extends_default","id","bottom","list","Fsinger_mid","Fsinger_name","Findex","val","other","BaseArtistList","_getArtistList","the_artist_artist","artistList","select","selectArtist","artist_Component","artist_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/2.d4003ac418bf3634ab0f.js","sourcesContent":["import jsonp from '@/common/js/jsonp'\r\nimport { commonParams, options, ARTIST_URL, ARTIST_DETAIL_URL } from './config'\r\n\r\nexport function getArtistList () {\r\n  const data = {\r\n    ...commonParams,\r\n    ...{\r\n      channel: 'singer',\r\n      page: 'list',\r\n      key: 'all_all_all',\r\n      pagesize: 100,\r\n      pagenum: 1,\r\n      hostUin: 0,\r\n      needNewCode: 0,\r\n      platform: 'yqq',\r\n      g_tk: 1471438518 // 后面的拓展运算符的值会覆盖之前的同 key 的值， Object.assign 同理\r\n    }\r\n  }\r\n  return jsonp(ARTIST_URL, data, options)\r\n}\r\n\r\nexport function getArtistDetail (artistId) {\r\n  const data = {\r\n    ...commonParams,\r\n    ...{\r\n      g_tk: 1471438518,\r\n      hostUin: 0,\r\n      needNewCode: 0,\r\n      platform: 'yqq',\r\n      order: 'listen',\r\n      begin: 0,\r\n      num: 30,\r\n      songstatus: 1,\r\n      singermid: artistId\r\n    }\r\n  }\r\n  return jsonp(ARTIST_DETAIL_URL, data, options)\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/the-artist.js","<template>\r\n  <BaseScroll\r\n    :data=\"artistData\"\r\n    :listenScroll=\"listenScroll\"\r\n    :probeType=\"probeType\"\r\n    @scroll=\"scroll\"\r\n    class=\"scroll-wrapper\"\r\n    ref=\"list\"\r\n  >\r\n    <ul>\r\n      <li\r\n        class=\"list-group\"\r\n        v-for=\"(group, index) of artistData\"\r\n        :key=\"index\"\r\n        ref=\"group\"\r\n        >\r\n        <h2 class=\"list-group-title\">{{ group.title }}</h2>\r\n        <ul>\r\n          <li\r\n            class=\"list-group-item\"\r\n            v-for=\"(item, childIndex) of group.items\"\r\n            :key=\"childIndex\"\r\n            @click=\"selectItem(item)\"\r\n          >\r\n            <!-- 图像懒加载 -->\r\n            <img v-lazy=\"item.avatar\" width=\"50\" height=\"50\" alt=\"artist-avatar\">\r\n            <span class=\"artist-name\">{{ item.name }}</span>\r\n          </li>\r\n        </ul>\r\n      </li>\r\n    </ul>\r\n\r\n    <div class=\"list-shortcut\" v-show=\"artistData.length\">\r\n      <ul>\r\n        <li\r\n          v-for=\"(item, index) of shortcutList\"\r\n          :key=\"index\"\r\n          :data-index=\"index\"\r\n          :class=\"['list-shortcut-item', currentIndex === index ? 'active' : '']\"\r\n          @touchstart=\"onShortcutToTouchStart\"\r\n          @touchmove.stop.prevent=\"onShortcutToTouchMove\"\r\n        >\r\n          <span class=\"list-shortcut-content\">{{ item }}</span>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div\r\n      class=\"fixed-title\"\r\n      v-show=\"scrollY < 0\"\r\n      :style=\"translateY\"\r\n    >\r\n      <h1 class=\"fixed-title-content\">{{ fixedTitle }}</h1>\r\n    </div>\r\n\r\n    <BaseLoading v-if=\"artistData.length === 0\"/>\r\n  </BaseScroll>\r\n</template>\r\n\r\n<script>\r\n/**\r\n * 开发时，热刷新本组件将清空 this.listHeight，则每次修改本组件都必须刷新页面才能正确\r\n * 获得 this.listHeight（因为计算 this.listHeight 是由监听 artistData 触发）\r\n */\r\nimport BaseScroll from 'base/base-scroll'\r\nimport { getData } from 'common/js/control-dom'\r\nimport BaseLoading from 'base/base-loading/base-loading'\r\n\r\nconst ANCHOR_HEIGHT = 18 // 侧边导航单个 li 元素高度\r\nconst TITLE_HEIGHT = 30 // 顶端标题的高度，用于计算差值\r\n\r\nexport default {\r\n  props: {\r\n    artistData: {\r\n      type: Array,\r\n      default () {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      scrollY: -1, // 当前滚动 scrollY 值，如同 window.scrollY\r\n      currentIndex: 0, // 当前 title 的 index\r\n      difference: 0 // scrollY 与 i + 1 锚点 y 坐标的差值\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    shortcutList () {\r\n      return this.artistData.map(group => {\r\n        return group.title.substr(0, 1) // 返回首字母\r\n      })\r\n    },\r\n\r\n    fixedTitle () {\r\n      return this.artistData[this.currentIndex] ? this.artistData[this.currentIndex].title : []\r\n    },\r\n\r\n    translateY () {\r\n      if (this.difference && this.difference < TITLE_HEIGHT) {\r\n        return {\r\n          transform: `translateY(${-(TITLE_HEIGHT - this.difference)}px)`\r\n        }\r\n      } else {\r\n        return {}\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    // 得到锚点 index ，调用 better-scroll 方法跳转至锚点\r\n    onShortcutToTouchStart (evt) {\r\n      let anchorIndex = getData(evt.target, 'index') // 得到自定义 data-index 值\r\n      this.touch.y1 = evt.touches[0].pageY // pageY 触摸目标在 HTML 文档中的 Y 坐标\r\n      this.touch.anchorIndex = anchorIndex\r\n      this._scrollTo(anchorIndex)\r\n    },\r\n    // 计算偏移距离，以至于得到偏移个数，之后调用跳转元素方法，达到 touchmove 滚动 list 的效果\r\n    onShortcutToTouchMove (evt) {\r\n      this.touch.y2 = evt.touches[0].pageY\r\n      let jumpNumber = (this.touch.y2 - this.touch.y1) / ANCHOR_HEIGHT | 0 // 触摸偏移。其中设置初始值 0\r\n      let anchorIndex = parseInt(this.touch.anchorIndex) + jumpNumber // anchorIndex 为字符串\r\n      this._scrollTo(anchorIndex)\r\n    },\r\n\r\n    refresh () {\r\n      this.$refs.list.refresh()\r\n    },\r\n\r\n    scroll (pos) {\r\n      this.scrollY = pos.y\r\n    },\r\n\r\n    _scrollTo (index) {\r\n      if (!index && index !== 0) { // 排除 index 为 null\r\n        return\r\n      }\r\n      if (index < 0) {\r\n        index = 0\r\n      } else if (index > this.listHeight.length - 2) {\r\n        index = this.listHeight.length - 2\r\n      }\r\n      this.scrollY = -this.listHeight[index] // 效果：点击行为切换 active 类\r\n      this.$refs.list.scrollToElement(this.$refs.group[index], 0) // 调用子组件方法跳转至锚点, 0表示动画时间\r\n    },\r\n\r\n    _calculateHeight () {\r\n      this.listHeight = []\r\n      const list = this.$refs.group\r\n      let height = 0\r\n      this.listHeight.push(height)\r\n\r\n      for (let i = 0; i < list.length; i++) {\r\n        // clientHeight = height + padding - 水平滚动条\r\n        height += list[i].clientHeight\r\n        this.listHeight.push(height)\r\n      }\r\n    },\r\n\r\n    selectItem (item) { // 路由跳转\r\n      this.$emit('select', item)\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    artistData () {\r\n      setTimeout(() => {\r\n        this._calculateHeight()\r\n      }, 20)\r\n    },\r\n\r\n    scrollY (newY) {\r\n      const listHeight = this.listHeight // 开发时，刷新本组件将清空 this.listHeight，则必须刷新页面才能正确获得 this.listHeight\r\n\r\n      // 滚动到顶端时，newY > 0\r\n      if (newY > 0) {\r\n        this.currentIndex = 0\r\n        return\r\n      }\r\n      // 滚动到中间部分\r\n      for (let i = 0; i < listHeight.length - 1; i++) {\r\n        let heightStart = listHeight[i]\r\n        let heightEnd = listHeight[i + 1]\r\n        if (-newY >= heightStart && -newY < heightEnd) {\r\n          this.currentIndex = i\r\n          this.difference = this.listHeight[i + 1] - (-newY)\r\n          return\r\n        }\r\n      }\r\n      // 滚动到底部，且 -newY > 最后一个元素的上限\r\n      this.currentIndex = listHeight.length - 2\r\n    }\r\n  },\r\n\r\n  created () {\r\n    // vue 在初始化组件时会将 data 和 props 中数据对象添加 getter 和 setter ，从而达到监听数据变化(以更新 DOM)的目的\r\n\r\n    // this.touch 并不需要监听观测变化(以更新 DOM)，是组件内部的一个缓存数据的容器，故在 created 钩子中创建并初始化\r\n    this.touch = {} // 滚动坐标容器\r\n\r\n    this.listenScroll = true // 传入 base-scroll，是否需要监听滚动\r\n\r\n    this.listHeight = [] // 元素高度的存储容器\r\n\r\n    this.probeType = 3 // better-scroll 是否节流，节流（值为0）表现为只有 touch 时的滚动才被监听，不会监听手指离开屏幕滑动页面时的滚动\r\n  },\r\n\r\n  components: {\r\n    BaseScroll,\r\n    BaseLoading\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '~scss/variables';\r\n\r\n%title {\r\n  height: 30px;\r\n  line-height: 30px;\r\n  padding-left: 20px;\r\n  font-size: $font-size-small;\r\n  color: $color-text-l;\r\n  background-color: $color-highlight-background;\r\n}\r\n\r\n.scroll-wrapper {\r\n  position: relative;\r\n  top: 0;\r\n  left: 0;\r\n  overflow: hidden;\r\n  height: 100%; // 取父元素高度\r\n  font-size: 0;\r\n  .list-group {\r\n    padding-bottom: 30px;\r\n    .list-group-title {\r\n      @extend %title\r\n    }\r\n    .list-group-item {\r\n      display: flex;\r\n      align-items: center;\r\n      padding: 20px 0 0 30px;\r\n      img {\r\n        border-radius: 50%;\r\n      }\r\n      .artist-name {\r\n        margin-left: 20px;\r\n        color: $color-text-l;\r\n        font-size: $font-size-medium;\r\n      }\r\n    }\r\n  }\r\n  .list-shortcut {\r\n    position: absolute;\r\n    top: 50%;\r\n    right: 10px;\r\n    transform: translateY(-50%);\r\n    z-index: 10;\r\n    width: 20px;\r\n    padding: 20px 0;\r\n    text-align: center;\r\n    border-radius: 10px;\r\n    background-color: $color-background-d;\r\n    .list-shortcut-item {\r\n      padding: 3px;\r\n      line-height: 1;\r\n      color: $color-text-l;\r\n      &.active {\r\n        color: $color-theme;\r\n      }\r\n      .list-shortcut-content {\r\n        font-size: $font-size-small;\r\n      }\r\n    }\r\n  }\r\n  .fixed-title {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    .fixed-title-content {\r\n      @extend %title\r\n    }\r\n  }\r\n  .loading {\r\n    position: absolute;\r\n    top: 50%;\r\n    transform: translateY(-50%);\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/base/base-artist-list.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('BaseScroll',{ref:\"list\",staticClass:\"scroll-wrapper\",attrs:{\"data\":_vm.artistData,\"listenScroll\":_vm.listenScroll,\"probeType\":_vm.probeType},on:{\"scroll\":_vm.scroll}},[_c('ul',_vm._l((_vm.artistData),function(group,index){return _c('li',{key:index,ref:\"group\",refInFor:true,staticClass:\"list-group\"},[_c('h2',{staticClass:\"list-group-title\"},[_vm._v(_vm._s(group.title))]),_vm._v(\" \"),_c('ul',_vm._l((group.items),function(item,childIndex){return _c('li',{key:childIndex,staticClass:\"list-group-item\",on:{\"click\":function($event){_vm.selectItem(item)}}},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.avatar),expression:\"item.avatar\"}],attrs:{\"width\":\"50\",\"height\":\"50\",\"alt\":\"artist-avatar\"}}),_vm._v(\" \"),_c('span',{staticClass:\"artist-name\"},[_vm._v(_vm._s(item.name))])])}))])})),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.artistData.length),expression:\"artistData.length\"}],staticClass:\"list-shortcut\"},[_c('ul',_vm._l((_vm.shortcutList),function(item,index){return _c('li',{key:index,class:['list-shortcut-item', _vm.currentIndex === index ? 'active' : ''],attrs:{\"data-index\":index},on:{\"touchstart\":_vm.onShortcutToTouchStart,\"touchmove\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.onShortcutToTouchMove($event)}}},[_c('span',{staticClass:\"list-shortcut-content\"},[_vm._v(_vm._s(item))])])}))]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.scrollY < 0),expression:\"scrollY < 0\"}],staticClass:\"fixed-title\",style:(_vm.translateY)},[_c('h1',{staticClass:\"fixed-title-content\"},[_vm._v(_vm._s(_vm.fixedTitle))])]),_vm._v(\" \"),(_vm.artistData.length === 0)?_c('BaseLoading'):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-746ffbc4\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/base/base-artist-list.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-746ffbc4\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./base-artist-list.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./base-artist-list.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./base-artist-list.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-746ffbc4\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./base-artist-list.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-746ffbc4\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/base-artist-list.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div class=\"artist\" ref=\"artist\">\r\n    <BaseArtistList\r\n      ref=\"artistList\"\r\n      :artistData=\"artistList\" @select=\"selectArtist\"\r\n    />\r\n    <router-view/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getArtistList } from 'api/the-artist'\r\nimport { ERR_OK } from 'api/config'\r\nimport BaseArtistList from 'base/base-artist-list'\r\nimport Artist from 'common/js/normalize-artist'\r\nimport { mapMutations } from 'vuex'\r\nimport { playlistMixin } from 'common/js/mixin'\r\n\r\nconst HOT_NAME = '热门'\r\nconst HOT_ARTIST_LENGTH = 10\r\n\r\nexport default {\r\n  mixins: [playlistMixin],\r\n  data () {\r\n    return {\r\n      artistList: []\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    selectArtist (artist) {\r\n      // path 覆盖 params\r\n      this.$router.push({ path: `/artist/${artist.id}` })\r\n      this.setArtist(artist)\r\n    },\r\n\r\n    handlePlaylist (playlist) {\r\n      const bottom = playlist.length > 0 ? '60px' : ''\r\n\r\n      this.$refs.artist.style.bottom = bottom\r\n      this.$refs.artistList.refresh()\r\n    },\r\n\r\n    // handlePlayList (playlist) {\r\n    //   const bottom = playlist.length > 0 ? '60px' : ''\r\n    //   this.$refs.artist.style.bottom = bottom\r\n    //   this.$refs.artistList.refresh()\r\n    // },\r\n\r\n    _getArtistList () {\r\n      getArtistList().then(res => {\r\n        if (res.code === ERR_OK) {\r\n          this.artistList = this._normalizeArtistList(res.data.list)\r\n        } else {\r\n          throw new Error('Check ERR_OK failed')\r\n        }\r\n      })\r\n    },\r\n\r\n    _normalizeArtistList (list) {\r\n      let map = {\r\n        hot: {\r\n          title: HOT_NAME,\r\n          items: []\r\n        }\r\n      }\r\n      list.forEach((item, index) => {\r\n        if (index < HOT_ARTIST_LENGTH) { // 前 10 项加入“热门”标签，但仍参加后续分类\r\n          map.hot.items.push(new Artist({\r\n            id: item.Fsinger_mid,\r\n            name: item.Fsinger_name\r\n          }))\r\n        }\r\n        // 将 json 中的所有项根据 Findex 归类\r\n        const key = item.Findex\r\n        if (!map[key]) {\r\n          map[key] = {\r\n            title: key,\r\n            items: []\r\n          }\r\n        }\r\n        map[key].items.push(new Artist({\r\n          id: item.Fsinger_mid,\r\n          name: item.Fsinger_name\r\n        }))\r\n      })\r\n      // 对象遍历是无序的，故处理 map 为数组使得遍历时有序\r\n      let ret = []\r\n      let hot = []\r\n      let other = [] // 索引为非 hot 和 非字母开头\r\n      for (let key in map) {\r\n        let val = map[key]\r\n        if (val.title.match(/[a-zA-Z]/)) {\r\n          ret.push(val)\r\n        } else if (val.title === HOT_NAME) {\r\n          hot.push(val)\r\n        } else {\r\n          val.title = '#' // 将非 hot 和 非字母开头的 title 转换为统一符号'#'\r\n          other.push(val)\r\n        }\r\n      }\r\n      ret.sort((a, b) => {\r\n        // ret 中按首字母 unicode 升序\r\n        return a.title.charCodeAt(0) - b.title.charCodeAt(0)\r\n      })\r\n      return [...hot, ...ret, ...other]\r\n    },\r\n\r\n    ...mapMutations({\r\n      setArtist: 'SET_ARTIST' // 将 `this.setArtist()` 映射为 `this.$store.commit('SET_ARTIST')`\r\n    })\r\n  },\r\n\r\n  components: {\r\n    BaseArtistList\r\n  },\r\n\r\n  created () {\r\n    this._getArtistList()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '~scss/variables';\r\n\r\n.artist {\r\n  position: fixed;\r\n  top: 88px;\r\n  bottom: 0;\r\n  width: 100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/the-artist/artist.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"artist\",staticClass:\"artist\"},[_c('BaseArtistList',{ref:\"artistList\",attrs:{\"artistData\":_vm.artistList},on:{\"select\":_vm.selectArtist}}),_vm._v(\" \"),_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-23d2c966\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/the-artist/artist.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-23d2c966\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./artist.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./artist.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./artist.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-23d2c966\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./artist.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-23d2c966\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/the-artist/artist.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}